#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass dlrreport
\use_default_options true
\maintain_unincluded_children false
\language ngerman
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language german
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Ordinary Kriging
\end_layout

\begin_layout Section
TODO
\end_layout

\begin_layout Standard
Ordinary Kriging GEK CO-Kriging (eigenen Teil kenntlich machen) - Was kann
 es darstellen und was nicht, auch die Kompromisse in der Kovarianzfunktion
 zeigen, z.B.
 bei Erichs Beispiel mit der zufälligen Low Fidelity Funktion.
 Das Model gibt es eigentlich nicht her, trotzdem schafft er es oftmals
 einen guten Kompromiss zu finden.
 Training wird aber instabiler dadurch - Initialisierungsverfahren - Minimierung
sverfahren / Konvergenzkriterium - Varianz, Diagonalaufschlag, Aufbau der
 Korr Funktionen (exp) - Erzeugung der Cov Matrix und der Kov Funktionen
 - statistische Grundlagen einstreuen ( Multivariate Normalverteilung, Verschieb
ungssatz, Erwartungswerte usw.) - Likelihood - CovMatrix aufstellen - Hyperparame
ter - ortsabhängige Cov Funktion - CO Kriging Betas - Versuch Likelihood
 Schätzer Sigma - Diagonalaufschlag und Probleme beim Training
\end_layout

\begin_layout Section
Grundlagen Kriging
\begin_inset CommandInset label
LatexCommand label
name "chap:Grundlagen-Kriging"

\end_inset


\end_layout

\begin_layout Standard
Unter Kriging versteht man statistische Verfahren zur Interpolation von
 Werten an unbeprobten Orten.
 Der Name des Verfahrens stammt von dem südafrikanischen Bergbauingenieur
 Daniel Krige (1951), dieser versuchte eine optimale Interpolationsmethode
 für den Bergbau zu entwickeln, die auf der räumlichen Abhängigkeit von
 Messpunkten 
\begin_inset CommandInset citation
LatexCommand citep
key "kbiqb1953statistical"

\end_inset

 basiert.
 Das Verfahren wurde später nach ihm benannt.
 Der französische Mathematiker Georges Matheron (1963) entwickelte aus Kriges
 Arbeit, schließlich die Kriging Theorie
\begin_inset CommandInset citation
LatexCommand citep
key "matheron1963principles"

\end_inset

.
 Das Kriging Verfahren hat heute in den Geowissenschaften sowie vielen anderen
 Forschungsbereichen Verwendung gefunden.
\end_layout

\begin_layout Standard
Die Vorteile von Kriging gegenüber anderer Methoden, wie z.B.
 Inverser Distanzwichtung 
\begin_inset CommandInset citation
LatexCommand citep
key "shepard1968two"

\end_inset

, insbesondere bei der Nutzung innerhalb eines Optimierungsverfahrens, wie
 es im Institut für Antriebstechnik existiert, sind:
\end_layout

\begin_layout Itemize
Die Initialisierung ist sehr einfach, d.h.
 das Verfahren liefert so gut wie immer gute Ergebnisse unabhängig von irgendwel
chen Startparametern.
 Bei Neuronalen Netzwerken z.B.
 muss vor dem Training die Netztopologie, also die Anzahl der Gewichte und
 die Struktur des Netzes angegeben werden.
 Werden diese Parameter ungünstig gewählt, liefert das Neuronale Netz schlechte
 oder gar keine Ergebnisse.
 
\end_layout

\begin_layout Itemize
Das Extrapolationsverhalten ist bei einer Optimierung sehr vorteilhaft.
 Da man bei einer Optimierung sehr schnell in Bereiche kommt, wo das Ersatzmodel
l extrapolieren muss, sollten die vorhergesagten Werte möglichst sinnvoll
 sein.
 Beim Ordinary Kriging liefert das Modell bei einer Extrapolation den Erwartungs
wert.
 Ein Neuronales Netzwerk bspw.
 würde hier zufällige Werte vorhersagen, dies könnte bei einer Optimierung
 zu Schwierigkeiten führen.
 
\end_layout

\begin_layout Itemize
Kriging ist ein BLUE Schätzer 
\begin_inset CommandInset citation
LatexCommand citep
key "plackett1950some"

\end_inset

, Best Linear Unbiased Estimator.
 Also ein linearer Erwartungstreuer Schätzer minimaler Varianz.
 Im nächsten Abschnitt wird dies genauer erläutert.
\end_layout

\begin_layout Itemize
Viele nichtstatistische Verfahren, wie z.B.
 die Inverse Distanzwichtung 
\begin_inset CommandInset citation
LatexCommand citep
key "shepard1968two"

\end_inset

, beachten eine lokale Häufung von Stützstellen nicht.
 Bei einer lokalen Häufung von Stützstellen sollten diese weniger stark
 gewichtet werden.
 Ein statistisches Verfahren wie Kriging beinhaltet die gesamte räumliche
 Verteilung der Stützstellen 
\begin_inset CommandInset citation
LatexCommand citep
key "Krueger2013"

\end_inset

.
\end_layout

\begin_layout Subsection
Grundlegender Ansatz bei Kriging Verfahren
\end_layout

\begin_layout Standard
Im Folgenden sei 
\begin_inset Formula $D\subseteq\mathbb{R^{\mathrm{k}}}$
\end_inset

 das Untersuchungsgebiet.
 Der zu schätzende Wert an der Stelle 
\begin_inset Formula $\vec{x}_{0}\in R^{\mathrm{k}}$
\end_inset

 sei 
\begin_inset Formula $y^{*}\left(\vec{x}_{0}\right)$
\end_inset

.
 Zudem sind 
\begin_inset Formula $y\left(\vec{x}_{1}\right)..y\left(\vec{x}_{n}\right)$
\end_inset

 bereits bekannte Werte oder auch Stützstellen.
 Da Kriging ein statistisches Interpolationsverfahren ist, welches für den
 räumlichen Zusammenhang von beprobten Stützstellen statistische Begriffe
 wie Erwartungswert und Varianz verwendet, werden die raumbezogenen Daten
 als Realisation von Zufallsvariablen modelliert 
\begin_inset CommandInset citation
LatexCommand citep
key "Krueger2013"

\end_inset

.
 Die Stützstellen werden also als Realisierung von Zufallsvariablen 
\begin_inset Formula $Z\left(\vec{x}_{1}\right)..Z\left(\vec{x}_{n}\right)$
\end_inset

 betrachtet.
 Der zu schätzende unbeprobte Wert 
\begin_inset Formula $y^{*}\left(\vec{x}_{0}\right)$
\end_inset

 wird ebenfalls als Realisierung der Zufallsvariable 
\begin_inset Formula $Z\left(\vec{x}_{0}\right)$
\end_inset

 betrachtet, besitzt also einen Erwartungswert und eine Varianz.
 
\begin_inset Newline newline
\end_inset

Eine grundlegende Annahme bei Kriging ist, dass der zu schätzende Wert 
\begin_inset Formula $y^{*}\left(x_{0}\right)$
\end_inset

 durch eine gewichtete Summe berechnet werden kann.
 Diese Summe wird gebildet aus den Stützstellen 
\begin_inset Formula $y\left(\vec{x}_{1}\right)..y\left(\vec{x}_{n}\right)$
\end_inset

 und den zu bestimmenden Gewichten 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english

\begin_inset Formula $w_{1}...w_{n}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang ngerman
.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
y^{*}\left(\vec{x}_{0}\right) & =\sum_{i=1}^{n}w_{i}y\left(\vec{x}_{i}\right)\label{eq:GewichtetSumme}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Durch die Annahme, dass die beprobten und unbeprobten Werte als Realisierungen
 von Zufallsvariablen dargestellt werden, kommt man auf folgende Formulierung:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
Z^{*}\left(\vec{x}_{0}\right) & =\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\label{eq:GewichtetSummeStatistischerProzess}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Old/images/Kriging_ZDT3.eps

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Beispiel für eine Kriging Interpolation, die Rauten stellen Stützstellen
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english

\begin_inset Formula $y\left(x_{i}\right),i\in\left\{ 1...n\right\} $
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang ngerman
 am Ort 
\begin_inset Formula $x_{i},i\in\left\{ 1...n\right\} $
\end_inset

 im Untersuchungsgebiet 
\begin_inset Formula $D\subseteq\mathbb{R^{\mathrm{k}}}$
\end_inset

 und die Interpolation durch das Ordinary Kriging Verfahren
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Best Linear Unbiased Estimator
\end_layout

\begin_layout Standard
In diesem Abschnitt sollen einige grundlegende Annahmen getroffen werden,
 über diese und weitere Annahmen können dann die eigentlichen Gewichte bestimmt
 werden.
 
\begin_inset Formula $F$
\end_inset

 sei die Fehlerfunktion
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
F\left(\vec{x}_{0}\right) & =Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)=Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Kriging ist ein erwartungstreuer Schätzer, was bedeutet, dass der Schätzfehler
 im Mittel 0 ist.
 
\begin_inset Formula $E\left[X\right]$
\end_inset

 stellt hier den Erwartungswert der Variable 
\begin_inset Formula $X$
\end_inset

 dar.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
E\left[F\left(\vec{x}_{0}\right)\right] & =0\label{eq:ErwartungSchatzfehlerNull}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow & E\left[Z\left(\vec{x}_{0}\right)\right]-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]=0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =E\left[Z\left(\vec{x}_{0}\right)\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Der Krige Schätzer soll ein bestmöglicher Schätzer sein.
 Daraus folgt, dass die Varianz des Schätzfehlers minimal ist.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\min_{w_{1},...,w_{n}}\textrm{var}\left[Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right]\label{eq:VarianzMinimierungFormel}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Aus diesen Bedingungen ergibt sich, dass der Krige Schätzer ein sogenannter
 BLUE (Best Linear Unbiased Estimator) Schätzer ist.
 Das Best ergibt sich aus 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VarianzMinimierungFormel"

\end_inset

, Linear aus der gewichteten Summe 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GewichtetSumme"

\end_inset

 und unbiased aus der Erwartungstreue 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ErwartungSchatzfehlerNull"

\end_inset

.
\end_layout

\begin_layout Subsection
Ordinary Kriging
\end_layout

\begin_layout Standard
Die Annahme beim Ordinary Kriging ist, dass der statistische Prozess 
\begin_inset Formula $Z\left(\vec{x}\right)$
\end_inset

 einen konstanten aber unbekannten Erwartungswert hat, hier 
\begin_inset Formula $\beta\in\mathbb{R}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}\right)\right] & =\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Durch diese Annahme kann die Erwartungstreue aus Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ErwartungSchatzfehlerNull"

\end_inset

 umformuliert werden zu:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[F\left(x_{0}\right)\right] & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right] & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}_{0}\right)\right]-\sum_{i=1}^{n}w_{i}E\left[Z\left(\vec{x}_{i}\right)\right] & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\beta-\sum_{i=1}^{n}w_{i}\beta & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\beta\left(1-\sum_{i=1}^{n}w_{i}\right) & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
1 & =\sum_{i=1}^{n}w_{i}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection*
Bestimmung der Gewichte
\end_layout

\begin_layout Standard
Die Varianz des Schätzfehlers kann wie folgt umformuliert werden:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]=\textrm{var}\left[Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right]=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right)-E\left[Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\[
=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right)-\left(E\left[Z\left(\vec{x}_{0}\right)\right]-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\[
=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)-\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
 & = & E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)^{2}\right]\\
 &  & -E\left[2*\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right]\\
 &  & +E\left[\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
 & = & E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)^{2}\right]\\
 &  & -2*E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right]\\
 &  & +E\left[\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2*\textrm{cov}\left(Z\left(\vec{x}_{0}\right),Z^{*}\left(\vec{x}_{0}\right)\right)+\textrm{var}\left[Z^{*}\left(\vec{x}_{0}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Setzt man nun die Formulierung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GewichtetSumme"

\end_inset

 für 
\begin_inset Formula $Z^{*}\left(\vec{x}_{0}\right)$
\end_inset

 und 
\begin_inset Formula $var\left[Z^{*}\right]=E\left[\left(Z^{*}-E\left[Z^{*}\right]\right)^{2}\right]$
\end_inset

 kommt man nach einiger Rechnung zu folgender Gleichung.
 Die Kovarianzfunktion wird im Folgenden als gegeben und differenzierbar
 angesehen.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]=\textrm{var}\left[Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right]=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right)-E\left[Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right)-E\left[Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right]\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left(Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]+E\left[\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right]\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left(\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]-\left[\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)-\sum_{i=1}^{n}E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right]\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left(\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]-\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]^{2}-2\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]+\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=E\left[\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]^{2}\right]-E\left[2\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right]+E\left[\left(\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-E\left[2\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right]+E\left[\left(\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-E\left[2\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right]+E\left[\sum_{i=1}^{n}\sum_{j=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)*\left(w_{j}Z\left(\vec{x}_{j}\right)-E\left[w_{j}Z\left(\vec{x}_{j}\right)\right]\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-E\left[2\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]\left[\sum_{i=1}^{n}\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right]+\sum_{i=1}^{n}\sum_{j=1}^{n}E\left[\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)*\left(w_{j}Z\left(\vec{x}_{j}\right)-E\left[w_{j}Z\left(\vec{x}_{j}\right)\right]\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-E\left[2\left[\sum_{i=1}^{n}\left[Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right]*\left(w_{i}Z\left(\vec{x}_{i}\right)-E\left[w_{i}Z\left(\vec{x}_{i}\right)\right]\right)\right]\right]+\sum_{i=1}^{n}\sum_{j=1}^{n}cov\left[w_{i}Z\left(\vec{x}_{i}\right),w_{j}Z\left(\vec{x}_{j}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\sum_{i=1}^{n}\textrm{cov}\left(Z\left(\vec{x}_{0}\right),w_{i}Z\left(\vec{x}_{i}\right)\right)+\sum_{i=1}^{n}\sum_{j=1}^{n}w_{i}w_{j}\textrm{cov}\left(Z\left(\vec{x}_{i}\right),Z\left(\vec{x}_{j}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
In Matrix Schreibweise ergibt sich die folgende Formulierung, wobei 
\begin_inset Formula $\vec{w}\in\mathbb{R^{\mathrm{n}}}$
\end_inset

 den Gewichtsvektor, 
\begin_inset Formula $\mathbf{Cov\in\mathbb{R^{\mathrm{n\times n}}}}$
\end_inset

 die Kovarianzmatrix und 
\begin_inset Formula $\overrightarrow{\textrm{cov}}\mathbf{\in\mathbb{R^{\mathrm{n}}}}$
\end_inset

 darstellt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\overrightarrow{\textrm{cov}}\left(Z\left(\vec{x}_{0}\right),Z\left(\vec{x}\right)\right)^{T}*\vec{w}+\vec{w}^{T}*\mathbf{Cov}*\vec{w}\label{eq:VarianzFehlerZuCov}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Die Minimierungsaufgabe stellt sich nun also wie folgt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\begin{cases}
\min_{w_{1},...,w_{n}}\textrm{var}\left[Z\left(\vec{x}_{0}\right)-\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)\right]\\
\sum_{i=1}^{n}w_{i}=1
\end{cases}\label{eq:Minimierungsaufgabe}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Mit dieser Formulierung kann nun die Minimierungsaufgabe aus Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Minimierungsaufgabe"

\end_inset

 gemäß der Multiplikatorenmethode von Lagrange gelöst werden 
\begin_inset CommandInset citation
LatexCommand citep
key "bronteijn2008taschenbuch"

\end_inset

.
 Als Lagrange Funktion 
\begin_inset Formula $\Lambda\left(w,\lambda\right)$
\end_inset

 mit dem Lagrange Multiplikator 
\begin_inset Formula $\lambda$
\end_inset

 ergibt sich:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Lambda\left(w,\lambda\right):=\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]+\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)
\]

\end_inset


\end_layout

\begin_layout Standard
Die notwendige Bedingung für das Minimum ist:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\nabla_{\lambda,w}\left(\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]+\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right)=\vec{0}
\]

\end_inset


\end_layout

\begin_layout Standard
Setzt man Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VarianzFehlerZuCov"

\end_inset

 ein, erhält man das folgende Gleichungssystem:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\nabla_{w}\left(\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\overrightarrow{\textrm{cov}}\left(Z\left(\vec{x}_{0}\right),Z\left(\vec{x}_{i}\right)\right)^{T}*\vec{w}+\vec{w}^{T}*\mathbf{Cov}*\vec{w}+\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right)=\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\wedge\,\,\nabla_{\lambda}\left(\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\overrightarrow{\textrm{cov}}\left(Z\left(\vec{x}_{0}\right),Z\left(\vec{x}_{i}\right)\right)^{T}*\vec{w}+\vec{w}^{T}*\mathbf{Cov}*\vec{w}+\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right)=\vec{0}\label{eq:MinimierungMitKovarianz}
\end{align}

\end_inset


\end_layout

\begin_layout Subsubsection*
Einschub Korrelation 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Einschub-Korrelation"

\end_inset


\end_layout

\begin_layout Standard
Da die Kovarianzfunktion beliebig große Werte annehmen kann, ist es für
 die spätere Modellierung günstiger diese zu normieren.
 Die normierte Kovarianz ist die Korrelation und der Zusammenhang zwischen
 Kovarianz und Korrelation sieht wie folgt aus:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
c\left(X,Y\right) & =\frac{\textrm{cov}\left(X,Y\right)}{\sqrt{\textrm{var}\left(X\right)}\sqrt{\textrm{var}\left(Y\right)}}\label{eq:KorrelationKovarianzZusammenhang}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Zudem soll der räumliche Zusammenhang zwischen zwei Zufallsvariablen nicht
 von seiner absoluten Lage im Raum abhängig sein, sondern nur von deren
 Abstandsvektor 
\begin_inset Formula $h\in\mathbb{R^{\mathrm{n}}}=\left\{ x_{1}-y_{1},...,x_{n}-y_{n}\right\} $
\end_inset


\end_layout

\begin_layout Standard
Die Kovarianz zwischen zwei gleichen Zufallsvariablen ist per Definition
 die Varianz dieser Zufallsvariable:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{cov}\left(Z,Z\right) & =\textrm{var}\left(Z\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da die Kovarianz allerdings nur vom Abstandsvektor abhängig ist und der
 Abstandsvektor bei zwei gleichen Zufallsvariablen immer 
\begin_inset Formula $\vec{0}$
\end_inset

 ist, kann man daraus folgern, dass die Kovarianz zwischen zwei gleichen
 Zufallsvariablen immer konstant ist.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{cov}\left(Z,Z\right) & =\textrm{cov}\left(h=\vec{0}\right)=const.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Und somit ist auch die Varianz konstant:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\Longrightarrow\textrm{var}\left[Z\right] & =\sigma^{2}=const.\label{eq:VarianzKonstant}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Durch die Gleichungen 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:KorrelationKovarianzZusammenhang"

\end_inset

 und 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VarianzKonstant"

\end_inset

 kann man die Kovarianzfunktion durch die Korrelationsfunktion ersetzen
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
c\left(X,Y\right)\sigma^{2} & =\textrm{cov}\left(X,Y\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Und somit auch die Kovarianzmatrix durch die Korrelationsmatrix 
\begin_inset Formula $\mathbf{R}\in\mathbb{R^{\mathrm{n\times n}}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{Cov} & =\sigma^{2}\mathbf{R}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Damit lässt sich Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MinimierungMitKovarianz"

\end_inset

 umformulieren, wobei der Korrelationsvektor mit 
\begin_inset Formula $\vec{r}\in\mathbb{R^{\mathrm{n}}}=\left(c\left[Z\left(\vec{x}_{0}\right),Z\left(\vec{x}_{1}\right)\right],...,c\left[Z\left(\vec{x}_{0}\right),Z\left(\vec{x}_{n}\right)\right]\right)^{T},\vec{x}\in\mathbb{R^{\mathrm{k}}}$
\end_inset

 bezeichnet wird.
 Dieser beschreibt die Korrelationen zwischen dem Funktionswert, der vorhersagt
 werden soll und dem Stützstellenvektor 
\begin_inset Formula $\vec{y}_{s}$
\end_inset

.
 Da der Funktionswert 
\begin_inset Formula $y\left(x_{0}\right)$
\end_inset

 nicht bekannt ist, hängt die Korrelationsfunktion nur von dem Abstandsvektor
 
\begin_inset Formula $\vec{h}\in\mathbb{R^{\mathrm{k}}}=\left\{ x_{0}-x_{1},...,x_{k}-x_{k}\right\} $
\end_inset

 ab.
 Der Korrelationsvektor ergibt sich damit zu 
\begin_inset Formula $\vec{r}\in\mathbb{R^{\mathrm{n}}}=\left(c\left[\vec{x}_{0},\vec{x}_{1}\right],...,c\left[\vec{x}_{0},\vec{x}_{n}\right]\right)^{T},\vec{x}\in\mathbb{R^{\mathrm{k}}}$
\end_inset

.
 Wie eine solche Korrelationsfunktion konkret umgesetzt wird, folgt in Kaptitel
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Korrelationsfunktionen"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
Fortsetzung vom Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MinimierungMitKovarianz"

\end_inset

: 
\end_layout

\begin_layout Standard
Es ergibt sich folgendes Gleichungssystem:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\sigma^{2}\nabla_{w}\left(1-2\vec{r}^{T}*\vec{w}+\vec{w}^{T}*\mathbf{R}*\vec{w}\right)+\nabla_{w}\left(\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right) & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\wedge\,\,\sigma^{2}\nabla_{\lambda}\left(1-2\vec{r}^{T}*\vec{w}+\vec{w}^{T}*\mathbf{R}*\vec{w}\right)+\nabla_{\lambda}\left(\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right) & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\]

\end_inset

Aufgelöst:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\sigma^{2}\left(\nabla_{w}\left(-2\vec{r}^{T}*\vec{w}\right)+\nabla_{w}\left(\vec{w}^{T}*\mathbf{R}*\vec{w}\right)\right)+\nabla_{w}\left(\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right) & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\wedge\,\,\sigma^{2}\left(\nabla_{\lambda}\left(-2\vec{r}^{T}*\vec{w}\right)+\nabla_{\lambda}\left(\vec{w}^{T}*\mathbf{R}*\vec{w}\right)\right)+\nabla_{\lambda}\left(\lambda\left(\sum_{i=1}^{n}w_{i}-1\right)\right) & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da 
\begin_inset Formula $\textrm{cov}\left(X,Y\right)=\textrm{cov}\left(Y,X\right)$
\end_inset

 muss die Korrelationsmatrix 
\begin_inset Formula $\mathbf{R}$
\end_inset

 symmetrisch sein.
 Die Ableitung der quadratischen Form 
\begin_inset Formula $\nabla_{w}\left(\vec{w}^{T}*\mathbf{R}*\vec{w}\right)$
\end_inset

 ergibt sich somit zu 
\begin_inset Formula $2\mathbf{R}*\vec{w}$
\end_inset

 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\sigma^{2}\left(\left(-2\vec{r}\right)+2\mathbf{R}\vec{w}\right)+\lambda\vec{F} & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\wedge\,\,\sum_{i=1}^{n}w_{i}-1 & =\vec{0}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
wobei 
\begin_inset Formula $F_{i}=1$
\end_inset

 für 
\begin_inset Formula $ $
\end_inset


\begin_inset Formula $i=1...n$
\end_inset

 und 
\begin_inset Formula $F_{i}=0$
\end_inset

 für 
\begin_inset Formula $i>n$
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\mathbf{R}\vec{w}+\frac{\lambda\vec{F}}{2\sigma^{2}} & =\vec{r}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Formula 
\begin{align*}
\wedge\,\,\vec{F}^{T}\vec{w} & =1
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
In Matrix Schreibweise:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(\begin{array}{cc}
\mathbf{R} & \vec{F}\\
\vec{F}^{T} & 0
\end{array}\right)\left(\begin{array}{c}
\vec{w}\\
\frac{\lambda}{2\sigma^{2}}
\end{array}\right) & =\left(\begin{array}{c}
\vec{r}\\
1
\end{array}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\Leftrightarrow\left(\begin{array}{c}
\vec{w}\\
\frac{\lambda}{2\sigma^{2}}
\end{array}\right) & =\left(\begin{array}{cc}
\mathbf{R} & \vec{F}\\
\vec{F}^{T} & 0
\end{array}\right)^{-1}\left(\begin{array}{c}
\vec{r}\\
1
\end{array}\right)\label{eq:MatrixKrigingInverse}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Die Inverse der Blockmatrix ergibt sich nach 
\begin_inset CommandInset citation
LatexCommand citep
key "BlockMatrix"

\end_inset

 zu:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(\begin{array}{cc}
\mathbf{R} & \vec{F}\\
\vec{F}^{T} & 0
\end{array}\right)^{-1} & =\left(\begin{array}{cc}
\mathbf{R}^{-1}-\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}} & \frac{\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\\
\frac{\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}F} & -\frac{1}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}
\end{array}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Eingesetzt in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MatrixKrigingInverse"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(\begin{array}{c}
\vec{w}\\
\frac{\lambda}{2\sigma^{2}}
\end{array}\right) & =\left(\begin{array}{cc}
\mathbf{R}^{-1}-\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}} & \;\frac{\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\\
\frac{\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}F} & -\frac{1}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}
\end{array}\right)\left(\begin{array}{c}
\vec{r}\\
1
\end{array}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Daraus ergibt sich die folgende Formulierung der gesuchten Gewichte:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\vec{w} & =\mathbf{R}^{-1}\vec{r}-\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\vec{r}+\frac{\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\label{eq:FormelGewichte}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\vec{w} & =\mathbf{Cov}^{-1}\vec{c}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\label{eq:FormelGewichteCov}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Der zweite Term für 
\begin_inset Formula $\frac{\lambda}{2\sigma^{2}}$
\end_inset

 wird hierbei ignoriert, da nur die Formulierung der Gewichte gesucht war.
 Wird der Gewichtsvektor auf diese Weise berechnet, dann ist die Varianz
 
\begin_inset Formula $\textrm{var}\left[F\left(x_{0}\right)\right]$
\end_inset

 unter der geforderten Nebenbedingung minimal.
\end_layout

\begin_layout Subsubsection
Krige Schätzer 
\end_layout

\begin_layout Standard
Setzt man diese Formulierung in Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GewichtetSummeStatistischerProzess"

\end_inset

 ein, erhält man die Formel des Krige Schätzers, wobei der Vektor 
\begin_inset Formula $\vec{y}_{s}\in\mathbb{R^{\mathrm{n}}}$
\end_inset

 die bekannten Funktionswerte enthält.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
Z^{*}\left(\vec{x}_{0}\right) & =\sum_{i=1}^{n}w_{i}Z\left(\vec{x}_{i}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\sum_{i=1}^{n}w_{i}E\left[Z\left(\vec{x}_{i}\right)\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\vec{w}^{T}\vec{y}_{s}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\left(\mathbf{R}^{-1}\vec{r}-\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\vec{r}+\frac{\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\right)^{T}\vec{y}_{s}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\left(\mathbf{R}^{-1}\vec{r}\right)^{T}\vec{y}_{s}-\left(\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\vec{r}\right)^{T}\vec{y}_{s}+\left(\frac{\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\right)^{T}\vec{y}_{s}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\vec{r}^{T}\mathbf{R}^{-1}\vec{y}_{s}-\vec{r}^{T}\frac{\mathbf{R}^{-1}\vec{F}\vec{F}^{T}\mathbf{R}^{-1}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}\vec{y}_{s}+\frac{\vec{F}^{T}\mathbf{R}^{-1}\vec{y}_{s}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mu & =\frac{\vec{F}^{T}\mathbf{R}^{-1}\vec{y}_{s}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\vec{r}^{T}\mathbf{R}^{-1}\vec{y}_{s}-\vec{r}^{T}\mathbf{R}^{-1}\mu\vec{F}+\mu
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z^{*}\left(\vec{x}_{0}\right)\right] & =\vec{r}^{T}\mathbf{R}^{-1}\left(\vec{y}_{s}-\mu\vec{F}\right)+\mu
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\vec{F}$
\end_inset

 entspricht hier dem Einsvektor.
\end_layout

\begin_layout Standard
Beim Ordinary Kriging ist der Maximum Likelihood Schätzer für 
\begin_inset Formula $\beta=\frac{\vec{F}^{T}\mathbf{R}^{-1}\vec{y}_{s}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}$
\end_inset

 was der hier eingeführten Formulierung für 
\begin_inset Formula $\mu$
\end_inset

 entspricht.
 Grundsätzlich müssen diese Werte nicht identisch sein, wie es beim Co-Kriging
 auch der Fall ist.
\end_layout

\begin_layout Subsubsection
Vorhersage der Varianz des Fehlers
\end_layout

\begin_layout Standard
Die Varianz des Fehlers (siehe 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VarianzFehlerZuCov"

\end_inset

) wird bei Anwendung des Kriging Verfahrens oftmals mit herangezogen, um
 eine Fehlerabschätzung machen zu können.
 Um die Varianz des Fehlers vorherzusagen, ist es notwendig die Gewichte
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:FormelGewichteCov"

\end_inset

 in Formel 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VarianzFehlerZuCov"

\end_inset

 einzusetzen.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{w} & =\mathbf{Cov}^{-1}\vec{c}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\vec{c}^{T}*\left(\mathbf{Cov}^{-1}\vec{c}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)+\left(\mathbf{Cov}^{-1}\vec{c}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}*\mathbf{Cov}*\left(\mathbf{Cov}^{-1}\vec{c}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+2\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-2\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(\vec{c}^{T}\mathbf{Cov}^{-1}-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\right)*\left(\vec{c}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+2\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-2\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}-\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\right)*\left(\vec{c}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right] & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\right)*\left(\vec{c}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}-\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}*\left(\vec{c}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}-\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\vec{c}-\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}-\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\vec{c}+\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}-\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Zwischenrechnung
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}} & =\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}=\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da der Nenner ein Skalar ergibt, gilt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}} & =\left(\frac{\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}=\frac{\vec{c}\mathbf{Cov}^{-1}\vec{F}^{T}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\vec{c}^{T}\left(\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-2\vec{c}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\left(\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\right)^{T}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-2\vec{c}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\vec{c}^{T}\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c}-2\vec{c}\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{1}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\frac{1}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\left(\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c}-2\vec{c}\mathbf{Cov}^{-1}\vec{F}+1\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Bei dem Term in der Klammer handelt es sich nur um Skalare und damit entspricht
 dies einer quadratischen Gleichung, also gilt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
 & =\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-\vec{c}^{T}\mathbf{Cov}^{-1}\vec{c}+\frac{1}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\left(\vec{c}^{T}\mathbf{Cov}^{-1}\vec{F}-1\right)^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsubsection
Vorhersage der Kovarianz des Fehlers
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
cov\left[F_{1},F_{2}\right]=cov\left[Z_{1}-Z_{1}^{*},Z_{2}-Z_{2}^{*}\right]=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right)-E\left[Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\[
=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-Z^{*}\left(\vec{x}_{0}\right)\right)-\left(E\left[Z\left(\vec{x}_{0}\right)\right]-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\[
=E\left[\left(\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)-\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right)^{2}\right]
\]

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
 & = & E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)^{2}\right]\\
 &  & -E\left[2*\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right]\\
 &  & +E\left[\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
 & = & E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)^{2}\right]\\
 &  & -2*E\left[\left(Z\left(\vec{x}_{0}\right)-E\left[Z\left(\vec{x}_{0}\right)\right]\right)\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)\right]\\
 &  & +E\left[\left(Z^{*}\left(\vec{x}_{0}\right)-E\left[Z^{*}\left(\vec{x}_{0}\right)\right]\right)^{2}\right]
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2*\textrm{cov}\left(Z\left(\vec{x}_{0}\right),Z^{*}\left(\vec{x}_{0}\right)\right)+\textrm{var}\left[Z^{*}\left(\vec{x}_{0}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Vorhersage der Kovarianz zwischen 2 Vorhersagen
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
cov\left(y_{1}^{*},y_{2}^{*}\right)=cov\left(\vec{y_{s}}^{T}\vec{w}_{1},\vec{y_{s}}^{T}\vec{w}_{2}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow cov\left(\sum_{i=1}^{n_{all}}w_{1i}y_{i},\sum_{j=1}^{n_{all}}w_{2j}y_{j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow cov\left(\sum_{i=1}^{n_{all}}w_{1i}y_{i},\sum_{j=1}^{n_{all}}w_{2j}y_{j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
cov\left(\sum_{i=1}^{n_{all}}w_{1i}y_{i},\sum_{j=1}^{n_{all}}w_{2j}y_{j}\right)=E\left[\left(\sum_{i=1}^{n_{all}}w_{1i}y_{i}-E\left[\sum_{i=1}^{n_{all}}w_{1i}y_{i}\right]\right)*\left(\sum_{i=j}^{n_{all}}w_{2j}y_{j}-E\left[\sum_{j=1}^{n_{all}}w_{2j}y_{j}\right]\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow E\left[\left(\sum_{i=1}^{n_{all}}w_{1i}y_{i}-\sum_{i=1}^{n_{all}}E\left[w_{1i}y_{i}\right]\right)*\left(\sum_{j=1}^{n_{all}}w_{2j}y_{j}-\sum_{j=1}^{n_{all}}E\left[w_{2j}y_{j}\right]\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow E\left[\left(\sum_{i=1}^{n_{all}}\left(w_{1i}y_{i}-E\left[w_{1i}y_{i}\right]\right)\right)*\left(\sum_{j=1}^{n_{all}}\left(w_{2j}y_{j}-E\left[w_{2j}y_{j}\right]\right)\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow E\left[\left(\sum_{i=1}^{n_{all}}\sum_{j=1}^{n_{all}}\left(w_{1i}y_{i}-E\left[w_{1i}y_{i}\right]\right)\left(w_{2j}y_{j}-E\left[w_{2j}y_{j}\right]\right)\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow\sum_{i=1}^{n_{all}}\sum_{j=1}^{n_{all}}E\left[\left(w_{1i}y_{i}-E\left[w_{1i}y_{i}\right]\right)\left(w_{2j}y_{j}-E\left[w_{2j}y_{j}\right]\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow\sum_{i=1}^{n_{all}}\sum_{j=1}^{n_{all}}cov\left(w_{1i}y_{i},w_{2j}y_{j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Leftrightarrow\sum_{i=1}^{n_{all}}\sum_{j=1}^{n_{all}}w_{1i}w_{2j}cov\left(y_{i},y_{j}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
cov\left(y_{1},y_{2}\right)=\vec{w}_{1}^{T}\mathbf{Cov}\vec{w}_{2}\label{eq:CovGewichtsvektorenFormel}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Die Gewichtsvektoren sehen folgendermaßen aus:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{w_{1}} & =\mathbf{Cov}^{-1}\vec{c_{1}}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{1}}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{w_{2}} & =\mathbf{Cov}^{-1}\vec{c_{2}}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{2}}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Einsetzt in Formel 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:CovGewichtsvektorenFormel"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(\mathbf{Cov}^{-1}\vec{c_{1}}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{1}}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right)^{T}\mathbf{Cov} & \left(\mathbf{Cov}^{-1}\vec{c_{2}}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{2}}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow\left(\mathbf{Cov}^{-1}\vec{c_{1}}-\frac{\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{1}}+\frac{\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right)^{T} & \left(\vec{c_{2}}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{2}}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow\left(\vec{c_{1}}^{T}\mathbf{Cov}^{-1}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right) & \left(\vec{c_{2}}-\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{2}}+\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow & \vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\\
+ & \frac{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta-\frac{\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\frac{\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\vec{c_{2}}\beta+\frac{\vec{F}^{T}\mathbf{Cov}^{-1}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\frac{\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Leftrightarrow & \vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta\\
+ & \frac{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta-\frac{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\beta+\frac{\beta^{2}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\Leftrightarrow & \vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{2}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\beta^{2}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}\label{eq:covKrigingVorhersage}\\
\end{align}

\end_inset


\end_layout

\begin_layout Subsubsection
Varianz der Kriging Vorhersage
\end_layout

\begin_layout Standard
Die Varianz der Vorhersage scheint beim Kriging immer im Bereich der Gesamtvaria
nz des Kriging Prozesses zu liegen.
 Die erscheint zuerst merkwürdig, erwartet wurde hier ein Maß für die Streuung
 um die Vorhersage des Kriging Modells.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
var\left(y_{1}^{*}\right)=cov\left(y_{1}^{*},y_{1}^{*}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
var\left(y_{1}^{*}\right)= & \vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{c_{1}}-\frac{\vec{c_{1}}^{T}\mathbf{Cov}^{-1}\vec{F}\vec{F}^{T}\mathbf{Cov}^{-1}\vec{c_{1}}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}+\frac{\beta^{2}}{\vec{F}^{T}\mathbf{Cov}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Der Zusammenhang sollte über folgende Gleichung gegeben sein:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]=\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]-2*\textrm{cov}\left(Z\left(\vec{x}_{0}\right),Z^{*}\left(\vec{x}_{0}\right)\right)+\textrm{var}\left[Z^{*}\left(\vec{x}_{0}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Setzt man für den Covarianzvektor die Formulierung aus der Kriging Herleitung
 ein:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\textrm{var}\left[Z^{*}\left(\vec{x}_{0}\right)\right]=\textrm{var}\left[F\left(\vec{x}_{0}\right)\right]-\textrm{var}\left[Z\left(\vec{x}_{0}\right)\right]+2*\vec{c}^{T}\vec{w}
\]

\end_inset


\end_layout

\begin_layout Section
Andere Kriging Verfahren
\begin_inset CommandInset label
LatexCommand label
name "sec:Andere-Kriging-Verfahren"

\end_inset


\end_layout

\begin_layout Standard
Neben dem bereits erwähnten Ordinary Kriging gibt es eine Reihe anderer
 Kriging Verfahren.
 Diese unterscheiden sich meist durch die verschiedenen Annahmen, die im
 Modell getroffen werden und durch die Art der Daten, welche für das Training
 verwendet werden können.
 So war z.B.
 eine Annahme beim Ordinary Kriging, dass der Erwartungswert für alle Zufallsvar
iablen konstant aber unbekannt ist.
 
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}\right)\right] & =\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Ein weiteres Verfahren ist das Simple Kriging.
 Bei diesem ist die Bedingung das der Erwartungswert für alle Zufallsvariablen
 0 ist.
 
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}\right)\right] & =0
\end{align*}

\end_inset

Die Daten werden beim Simple Kriging meist auf einen Mittelwert von 0 skaliert:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{1}{n} & \overset{n}{\underset{i=1}{\sum}}y_{i}=0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Der reale Erwartungswert ist jedoch meist unbekannt und muss deswegen geschätzt
 werden.
\end_layout

\begin_layout Standard
Das Simple Kriging ist daher auch die einfachste Form der Kriging Annahmen,
 aber auch die am wenigsten allgemeine.
\end_layout

\begin_layout Standard
Universal Kriging ist eine Erweiterung des Ordinary Kriging.
 Der Erwartungswert 
\begin_inset Formula $\beta\left(\vec{x}\right)$
\end_inset

 ist nun nicht mehr konstant, sondern kann durch eine beliebige Funktion
 beschrieben werden.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
E\left[Z\left(\vec{x}\right)\right] & =\beta\left(\vec{x}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Einen anderen Ansatz verfolgen Variable Fidelity Methods (VFM).
 Diese Verfahren sollen Daten verschiedener Güte nutzen können.
 Das kann beispielsweise in der Strömungssimulation durch unterschiedlich
 feine Rechennetze von Vorteil sein.
 Sehr grobe Rechennetze liefern ungenauere Ergebnisse, dafür in deutlich
 kürzerer Zeit.
 Die Funktionen von groben und feinen Netzen sind sich vom Verlauf her sehr
 ähnlich, aber nicht identisch.
 Zudem vertraut man dem höherwertigen Modell mehr.
 Um dies zu erreichen, gibt es verschiedene Ansätze.
 Beispielsweise über eine additive Brückenfunktion.
 Hierfür würde ein Krigingmodell für die Daten höherer Güte trainiert 
\begin_inset Formula $y_{hf}\left(\vec{x}\right)$
\end_inset

 und ein Modell auf die Differenz zwischen den Daten niedrigerer Güte 
\begin_inset Formula $y_{lf}\left(\vec{x}\right)$
\end_inset

 und denen höherer Güte 
\begin_inset Formula $y_{diff}\left(\vec{x}\right)=y_{lf}\left(\vec{x}\right)-y_{hf}\left(\vec{x}\right)$
\end_inset

.
 Die sich daraus ergebende Brückenfunktion 
\begin_inset Formula $y_{b}\left(\vec{x}\right)$
\end_inset

 würde dann eine Addition aus dem Modell höherer Güte und dem Differenzmodell
 sein 
\begin_inset Formula $y_{b}\left(\vec{x}\right)=y_{lf}\left(\vec{x}\right)+y_{diff}\left(\vec{x}\right)$
\end_inset

.
 Neben dieser Brückenfunktion existiert auch noch ein Co-Kriging Verfahren,
 welches diesen Ansatz in einem Modell vereint 
\begin_inset CommandInset citation
LatexCommand citep
key "forrester2007multi"

\end_inset

.
 
\end_layout

\begin_layout Standard
Zusätzlich zu den bereits erwähnten Kriging Verfahren, gibt es noch diverse
 andere Verfahren, die in dieser Arbeit aber nicht erwähnt werden.
 Der Leser sei auf 
\begin_inset CommandInset citation
LatexCommand citep
key "delfiner2009geostatistics"

\end_inset

 verwiesen.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Bildungsvorschrift der Kovarianzmatrix
\begin_inset CommandInset label
LatexCommand label
name "sec:Bildungsvorschrift-der-Korrelati"

\end_inset


\end_layout

\begin_layout Standard
Die Kovarianzmatrix 
\begin_inset Formula $\mathbf{Cov}$
\end_inset

 beschreibt den paarweisen linearen Zusammenhang aller Stützstellen untereinande
r.
 Im Folgenden ist der allgemeine Aufbau einer Korrelationsmatrix zwischen
 zwei Membern mit den entsprechenden Kovarianz zwischen den Zufallsvariablen
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english

\begin_inset Formula $Z\left(\overrightarrow{x_{1}}\right)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang ngerman
 und 
\begin_inset Formula $Z\left(\overrightarrow{x_{2}}\right)$
\end_inset

 an den Orten 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english

\begin_inset Formula $\overrightarrow{x_{1}},\overrightarrow{x_{2}}\in\mathbb{R^{\textrm{k}}}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang ngerman
 dargestellt.
 Zusätzlich zu den Funktionswerten sind hier noch zwei partielle Ableitungen
 nach der ersten freien Variablen z.B.
 
\begin_inset Formula $\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}}$
\end_inset

 gegeben, wobei der obere Index von x die Variable nach der abgeleitet wird
 angibt und der untere Index die Membernummer.
 Die Kovarianzmatrix wurde hier aus Platzgründen nur mit zwei Membern gebildet
 und kann natürlich Kovarianzmatrix zwischen beliebig vielen Membern und
 partiellen Ableitungen enthalten.
 Die erste Spalte und erste Zeile geben jeweils an, zwischen welchen Variablen
 die Kovarianzmatrix gebildet wird, z.B.
 Spalte zwei 
\begin_inset Formula $Z\left(\overrightarrow{x_{2}}\right)$
\end_inset

 und Zeile eins 
\begin_inset Formula $Z\left(\overrightarrow{x_{1}}\right)$
\end_inset

 würden eine Korrelation 
\begin_inset Formula $c\left(Z\left(\overrightarrow{x_{1}}\right),Z\left(\vec{x}_{2}\right)\right)$
\end_inset

 ergeben.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center

\lang english
\begin_inset Formula 
\[
R=\left[\begin{array}{c|cccc}
 & Z\left(\vec{x}_{1}\right) & Z\left(\vec{x}_{2}\right) & \frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{1}^{1}}\\
\hline Z\left(\vec{x}_{1}\right) & c\left(Z\left(\vec{x}_{1}\right),Z\left(\vec{x}_{1}\right)\right) & c\left(Z\left(\vec{x}_{1}\right),Z\left(\vec{x}_{2}\right)\right) & c\left(x_{1},\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}}\right) & c\left(x_{1},\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}}\right)\\
Z\left(\vec{x}_{2}\right) & c\left(Z\left(\vec{x}_{2}\right),Z\left(\vec{x}_{1}\right)\right) & c\left(Z\left(\vec{x}_{2}\right),Z\left(\vec{x}_{2}\right)\right) & c\left(x_{2},\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}}\right) & c\left(x_{2},\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}}\right)\\
\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}} & c\left(\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}},Z\left(\vec{x}_{1}\right)\right) & c\left(\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}},Z\left(\vec{x}_{2}\right)\right) & c\left(\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}},\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}}\right) & c\left(\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}},\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}}\right)\\
\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{1}^{1}} & c\left(\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}},Z\left(\vec{x}_{1}\right)\right) & c\left(\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}},Z\left(\vec{x}_{2}\right)\right) & c\left(\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}},\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}}\right) & c\left(\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}},\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{2}^{1}}\right)
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Da für einen voherzusagenden Wert der Funktionswert unbekannt ist, die Kovarianz
 aber zwischen diesem und den bekannten Membern berechnet werden muss, beschreib
t man die Korrelation nur noch in Abhängigkeit vom Abstand der Stützstellen
 untereinander.
 Der Korrelationswert ist also unabhängig von den Funktionswerten.
 Dies stellt allerdings nur eine Schätzung der Korrelation dar, für die
 verschiedenste Ansätze existieren, einige davon werden in Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Korrelationsfunktionen"

\end_inset

 beschrieben.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
c\left(Z\left(\vec{x}_{1}\right),Z\left(\vec{x}_{2}\right)\right) & =c\left(\vec{x}_{1},\vec{x}_{2}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die Korrelation zwischen Funktionswerten und partiellen Ableitungen, bzw.
 zwischen partiellen Ableitungen und partiellen Ableitungen können wie in
 Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:CovpartielleAbleitungUmformung"

\end_inset

 umgeformt werden zu
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
c(\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{p}},Z\left(\vec{x}_{2}\right))= & \frac{\partial}{\partial x_{1}^{p}}c(Z\left(\vec{x}_{1}\right),Z\left(\vec{x}_{2}\right))
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
die Korrelation soll ebenfalls nur abhängig vom Abstand im Parameterraum
 sein
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
= & \frac{\partial}{\partial x_{1}^{p}}c(\vec{x}_{1},\vec{x}_{2})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die anderen Korrelationen für die partiellen Ableitungen sind in Kapitel
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Gradient-Enhanced-Kriging"

\end_inset

 zu finden.
 
\end_layout

\begin_layout Standard
Mit diesen Annahmen ergibt sich die allgemeine Form der Kovarianzmatrix
 zwischen zwei Membern zu 
\end_layout

\begin_layout Standard

\lang english
\begin_inset Formula 
\[
R=\left[\begin{array}{c|cccc}
 & Z\left(\vec{x}_{1}\right) & Z\left(\vec{x}_{2}\right) & \frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{1}^{1}}\\
\hline Z\left(\vec{x}_{1}\right) & c\left(\vec{x}_{1},\vec{x}_{1}\right) & c\left(\vec{x}_{1},\vec{x}_{2}\right) & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{2}\right)}{\partial x_{2}^{1}}\\
Z\left(\vec{x}_{2}\right) & c\left(\vec{x}_{2},\vec{x}_{1}\right) & c\left(\vec{x}_{2},\vec{x}_{2}\right) & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{2}\right)}{\partial x_{2}^{1}}\\
\frac{\partial Z\left(\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{1}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{2}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{1}\right)}{\partial x_{1}^{1}\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{1},\vec{x}_{2}\right)}{\partial x_{1}^{1}\partial x_{2}^{1}}\\
\frac{\partial Z\left(\vec{x}_{2}\right)}{\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{1}\right)}{\partial x_{2}^{1}} & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{2}\right)}{\partial x_{2}^{1}} & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{1}\right)}{\partial x_{2}^{1}\partial x_{1}^{1}} & \frac{\partial c\left(\vec{x}_{2},\vec{x}_{2}\right)}{\partial x_{2}^{1}\partial x_{2}^{1}}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Konkrete Korrelationsfunktionen, welche in dieser Software umgesetzt wurden,
 werden in Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Korrelationsfunktionen"

\end_inset

 beschrieben.
 Die Korrelationsfunktionen sollen innerhalb der Matrix austauschbar sein,
 was im entsprechenden Algorithmus zur Aufstellung der Matrix beachtet werden
 muss.
\end_layout

\begin_layout Section
Korrelationsfunktionen
\begin_inset CommandInset label
LatexCommand label
name "sec:Korrelationsfunktionen"

\end_inset


\end_layout

\begin_layout Standard
Um die Korrelationsmatrix aufzustellen, ist es nötig, einen Korrelationswert
 zwischen allen bekannten Stützstellen zu berechnen und auch zwischen den
 Stützstellen und deren partiellen Ableitungen.
 Um diesen Wert zu berechnen, wird eine Korrelationsfunktion verwendet.
 Wie bereits in Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Bildungsvorschrift-der-Korrelati"

\end_inset

 beschrieben, kann die Korrelationsfunktion nur angenähert werden und ist
 abhängig vom Abstand zweier Stützstellen zueinander.
 
\end_layout

\begin_layout Standard
In diesem Abschnitt soll eine sehr häufig verwendete Korrelationsfunktion
 beschrieben und deren softwaretechnische Umsetzung gezeigt werden.
 Da diese Korrelationsfunktion einer gaußschen Normalverteilung sehr ähnlich
 ist, wird diese im Folgenden als gaußsche Korrelationsfunktion bezeichnet.
 Die Formel sieht wie folgt aus:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
c\left(\vec{x}_{1},\vec{x}_{2}\right) & =e^{-\frac{1}{2}\underset{l=1}{\overset{l<k}{\sum}}\left(e^{\theta_{l}}\left|x_{1l}-x_{2l}\right|^{2}\right)}\label{eq:GaussCorrelationFunction}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Die Vektoren 
\begin_inset Formula $\vec{x}_{1},\vec{x}_{2}\in\mathbb{R^{\mathrm{k}}}$
\end_inset

 stellen hier die Ortsvektoren der Stützstellen dar.
 Die Funktion liefert immer Werte zwischen Null und Eins, wobei eine Eins
 bei zwei identischen Stützpunken und eine Null bei unendlich weit entfernten
 Stützstellen herauskommen würde.
 Der Vektor 
\begin_inset Formula $\vec{\theta}\in\mathbb{R^{\textrm{k}}}$
\end_inset

 (auch Hyperparameter genannt) legt fest, wie stark die Korrelation mit
 steigendem Abstand der Stützstellen zueinander abfällt, wobei ein hoher
 Wert einen stärkeren Abfall bewirkt.
 In Abbildung 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Beispiel-einer-Gauss"

\end_inset

 ist eine beispielhafte Korrelationsfunktion mit zwei verschiedenen 
\begin_inset Formula $\theta$
\end_inset

 Werten zu sehen, wobei die Stützstellen in der Abbildung jeweils nur eine
 freie Variable haben.
 Auf der X-Achse des Diagramms ist die Differenz der beiden Stützstellen
 zueinander aufgetragen und auf der Y-Achse der entsprechende Korrelationswert.
 Die rote durchgezogene Kurve zeigt die Korrelationsfunktion mit einem 
\begin_inset Formula $\theta=0.01$
\end_inset

 und die grüne gestrichelte Kurve hat ein 
\begin_inset Formula $\theta=0.1$
\end_inset

.
 Nimmt man eine Differenz der beiden Stützstellen von z.B.
 
\begin_inset Formula $\Delta x=-5$
\end_inset

 an, dann ergeben sich für einen Hyperparameter von 
\begin_inset Formula $\theta=0.01$
\end_inset

 ein Korrelationswert von 0.53 und für 
\begin_inset Formula $\theta=0.1$
\end_inset

 ein Korrelationswert von 0.08.
 In dem einen Fall wird also eine stärkere Abhängigkeit der beiden Stützstellen
 angenommen und im anderen Fall eine sehr schwache Abhängigkeit.
 Für das gesamte Kriging Modell gibt es genau einen 
\begin_inset Formula $\vec{\theta}$
\end_inset

 Vektor, die Bestimmung dieser Werte ist Aufgabe des Trainings.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Old/images/CorrelatoinFunction.eps
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Beispiel-einer-Gauss"

\end_inset

Beispiel einer Gauss Korrelationsfunktion mit einer freien Variable und
 zwei unterschiedlichen 
\begin_inset Formula $\theta$
\end_inset

 Einstellungen und deren Einfluss auf den Korrelationswert 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
In Abbildung 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Beispiel-einer-Gauss3D"

\end_inset

 wird eine Korrelationsfunktion zwischen zwei Stützstellen 
\begin_inset Formula $\vec{x}_{1},\vec{x}_{2}\in\mathbb{R^{\mathrm{k}}}$
\end_inset

 mit zwei freien Variablen 
\begin_inset Formula $k=2$
\end_inset

 gezeigt.
 Für diesen Fall hat der Vektor 
\begin_inset Formula $\vec{\theta}\in\mathbb{R^{\textrm{k}}}$
\end_inset

 ebenfalls zwei Komponenten.
 Auf der X-Achse ist die Differenz zwischen den beiden ersten Komponenten
 der beiden Stützstellen aufgetragen, auf der Y-Achse die Differenz zwischen
 den zweiten Komponenten der Stützstellenvektoren und die Z-Achse zeigt
 den entsprechenden Korrelationswert.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Old/images/CorrelatoinFunction3D.eps
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Beispiel-einer-Gauss3D"

\end_inset

Beispiel einer Gauss Korrelationsfunktion mit zwei freien Variablen
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
D
\end_layout

\begin_layout Section
Bestimmung der Hyperparameter durch die Maximum Likelihood Methode
\begin_inset CommandInset label
LatexCommand label
name "chap:Likelihood"

\end_inset


\end_layout

\begin_layout Standard
Wie in den vorherigen Kapiteln gezeigt wurde, hängen die einzelnen Korrelationsw
erte der Korrelationsmatrix maßgeblich von den verwendeten Hyperparametern
 ab und damit die Güte des Kriging Modells.
 Ziel eines Kriging Trainings ist es daher, die optimalen Hyperparameter
 zu finden.
 Um dies zu erreichen, wird die Maximum Likelihood Methode verwendet.
 
\end_layout

\begin_layout Standard
Im ersten Teil des Kapitels soll die Maximum Likelihood Methode anhand eines
 simplen Beispiels erklärt werden.
 Im Anschluss daran wird die Umsetzung dieser Methode für das hier verwendete
 Kriging Modell gezeigt.
 
\end_layout

\begin_layout Standard
Der letzte Abschnitt behandelt dann die softwaretechnische Umsetzung dieser
 Methode.
\end_layout

\begin_layout Section
Maximum Likelihood Methode
\end_layout

\begin_layout Standard
Um die optimalen Hyperparameter für das Kriging Modell zu finden, wird die
 Maximum Likelihood Methode verwendet.
 Diese Methode soll in diesem Abschnitt anhand eines einfachen Beispiels
 erklärt werden und im nächsten Abschnitt die Umsetzung dieser Methode für
 das Kriging Verfahren.
 Grundsätzlich ist die Maximum Likelihood Methode ein parametrisches Schätzverfa
hren in der Statistik.
 Es werden die Parameter gewählt, die bei einer vorgegebenen Verteilung
 am plausibelsten erscheinen.
 
\end_layout

\begin_layout Standard
Es wird von einer Zufallsvariablen 
\begin_inset Formula $X$
\end_inset

 ausgegangen, die Dichtefunktion dieser Zufallsvariablen 
\begin_inset Formula $f$
\end_inset

 hängt von einem oder mehreren Parametern ab.
 Die könnten z.B.
 bei einer Normalverteilung der Erwartungswert und die Standardabweichung
 sein.
 Der Einfachheit halber wird im folgenden ein Parameter 
\begin_inset Formula $p$
\end_inset

 verwendet.
 Liegt nun eine einfache Stichprobe mit 
\begin_inset Formula $n$
\end_inset

 Proben 
\begin_inset Formula $x_{1}..x_{n}$
\end_inset

 vor, lässt sich die Dichtefunktion in folgender Form faktorisieren, die
 dabei entstehende Funktion 
\begin_inset Formula $L$
\end_inset

 wird auch Likelihood Funktion genannt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
L\left(p\right) & =\overset{}{\underset{i=1}{\prod}f\left(x_{i},p\right)}\label{eq:Likelihood Funktion}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Wird diese Funktion nun in Abhängigkeit von 
\begin_inset Formula $q$
\end_inset

 maximiert, erhält man die Maximum-Likelihood-Schätzung für 
\begin_inset Formula $q$
\end_inset

.
 Man erhält also die Dichtefunktion bei der die Werte 
\begin_inset Formula $x_{1}..x_{n}$
\end_inset

 die größte Dichte unter Abhängigkeit von 
\begin_inset Formula $q$
\end_inset

 haben und welche damit auch am plausibelsten erscheint.
 
\end_layout

\begin_layout Standard
In Abbildung 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Zwei-mögliche-Normalverteilungen"

\end_inset

 ist ein einfaches Beispiel dargestellt.
 Es wurden für das Beispiel zufällig 9 Punkte erzeugt (bekannte Funktionswerte).
 Hierfür wurde ein Zufallsgenerator verwendet, welcher der schwarzen gestrichelt
en Verteilung folgt.
 Dieser stellt also die optimale Verteilungsfunktion für die Stichprobe
 dar.
 Aufgabe einer Maximum-Likelihood-Schätzung wäre es nun, die plausibelste
 Normalverteilung für die gegebene Stichprobe zu finden.
 Die Parameter für die Schätzung wären hier die Standardabweichung 
\begin_inset Formula $\sigma$
\end_inset

 und der Erwartungswert 
\begin_inset Formula $\mu$
\end_inset

 einer Normalverteilung.
 In Abbildung 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Zwei-mögliche-Normalverteilungen"

\end_inset

 wurden zwei Normalverteilungen mit zwei verschiedenen Parametersätzen gebildet,
 wobei die schwarze gestrichelte Linie die richtige und die durchgezogenen
 orangene die falsche Normalverteilung darstellen.
 Berechnet man nun die Likelihood Funktion (Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Likelihood Funktion"

\end_inset

) für beide Verteilungen, so sieht man bereits anhand der Grafik, dass bei
 der falschen Verteilung so gut wie alle Funktionswerte kleiner sind als
 die Funktionswerte bei der richtigen Verteilung.
 Daher wird auch das Produkt dieser Funktionswerte bei der richtigen Verteilung
 größer sein und den höheren Likelihood Wert bekommen.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Old/images/MLH_Verteilungen.png
	scale 35

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Zwei-mögliche-Normalverteilungen"

\end_inset

Zwei Normalverteilungen bei gegebenen Stichproben, die Stichproben wurden
 gemäß der gestrichelten Normalverteilung erzeugt.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
\noindent
Maximum Likelihood für Ordinary Kriging Modelle
\begin_inset CommandInset label
LatexCommand label
name "sec:Maximum-Likelihood-für"

\end_inset


\end_layout

\begin_layout Standard
\noindent
Um die Maximum Likelihood Methode für das Kriging Modell zu nutzen, wird
 angenommen, dass die Funktionswerte normalverteilt sind.
 Daraus ergibt sich eine multivariate Normalverteilung mit konstantem Erwartungs
wert: 
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
N= & \frac{1}{\left(2\pi\right)^{\frac{n}{2}}\det\left(\mathbf{Cov}\right)^{\frac{1}{2}}}e^{-\frac{1}{2}\left(\vec{y}_{s}-\vec{F}\beta\right)^{T}\mathbf{Cov^{\textrm{-1}}}\left(\vec{y}_{s}-\vec{F}\beta\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Wobei der Vektor 
\begin_inset Formula $\vec{F}$
\end_inset

 beim Ordinary-Kriging dem Vektor 
\begin_inset Formula $\vec{1}$
\end_inset

 entspricht und beim Gradient-Enhanced-Kriging sind die ersten 
\begin_inset Formula $n-m$
\end_inset

 Einträge Eins und für die restlichen 
\begin_inset Formula $m$
\end_inset

 Einträge Null.
 Unter der Annahme einer globalen Varianz 
\begin_inset Formula $\sigma^{2}$
\end_inset

 ergibt sich:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
N= & \frac{1}{\left(2\pi\right)^{\frac{n}{2}}\sigma^{2n}\det\left(\mathbf{R\left(\overrightarrow{\theta}\right)}\right)^{\frac{1}{2}}}e^{-\frac{1}{2}\left(\vec{y}_{s}-\vec{F}\beta\right)^{T}\mathbf{\frac{1}{\sigma^{2}}R\left(\overrightarrow{\theta}\right)^{\textrm{-1}}}\left(\vec{y}_{s}-\vec{F}\beta\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Die Matrix 
\begin_inset Formula $\mathbf{R}$
\end_inset

 wird wie in Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Korrelationsmatrix"

\end_inset

 beschrieben durch Korrelationsfunktionen einer echten Korrelationsmatrix
 angenähert und ist somit von Hyperparametern 
\begin_inset Formula $\vec{\theta}$
\end_inset

 abhängig.
 Der Maximum Likelihood Schätzer muss die Hyperparameter finden, die den
 Dichtefunktionswert der Normalverteilung N maximieren.
 In Abbildung 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:DichteKrigingMaxLike"

\end_inset

 sind zwei beispielhafte Normalverteilungen gezeigt.
 Es gibt in diesen Verteilungen jeweils zwei verschiedene Funktionswerte,
 der Vektor 
\begin_inset Formula $\vec{y}_{s}$
\end_inset

 beinhaltet also genau zwei Werte.
 Die Funktionswerte befinden sich in der Grafik in der rechten oberen Ecke,
 der Schwarze Punkt markiert die entsprechende Stelle.
 Ein Maximum Likelihood Schätzer müsste in diesem Fall den höchsten Dichtefunkti
onswert für den schwarzen Punkt finden.
 Um dies zu veranschaulichen wurden auf der linken Seite die Hyperparameter
 so eingestellt, dass eine sehr hohe Korrelation zwischen den Werten angenommen
 wurde.
 Der Dichtefunktionswert beträgt hier 0,33.
 Bei der rechten Grafik wurden die Hyperparameter so eingestellt, dass so
 gut wie keine Korrelation zwischen den beiden Funktionswerten angenommen
 wurde.
 Der Dichtefunktionswert beträgt hier nur 0,13.
 Der Maximum Likelihood Schätzer würde hier also die Hyperparameter aus
 der linken Funktion bevorzugen.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Old/images/MLH_KrigingVerteilungen.png
	lyxscale 50
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:DichteKrigingMaxLike"

\end_inset

Multivariate Normalverteilung mit zwei Funktionswerten.
 Links mit hoher Korrelation zwischen den Funktionswerten und rechts mit
 niedriger Korrelation.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
Da in der Realität meist hunderte oder tausende Funktionswerte vorhanden
 sind, wird die Normalverteilung N numerisch maximiert.
 Um dies so effizient wie möglich zu gestalten, lässt sich die Normalverteilung
 N noch auf folgende Weise vereinfachen.
 Der Logarithmus ist eine monotone Funktion.
 Daher ist das Maximum von N und log(N) an der selben Stelle im Parameterraum.
\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align*}
\log(N)= & \log(1)-\left(\frac{n}{2}\log(2\pi)+\frac{1}{2}\log\left(\sigma^{2n}\det(\mathbf{R})\right)\right)-\frac{1}{2}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\frac{1}{\sigma^{2}}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Da das Maximum der Funktion bestimmt werden soll, können die Konstanten
 ignoriert werden:
\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align*}
\log(N)= & -\frac{1}{2}\log\left(\sigma^{2n}\det(\mathbf{R})\right)-\frac{1}{2}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\frac{1}{\sigma^{2}}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align}
\log(N)= & -\frac{n}{2}\log\left(\sigma^{2}\right)-\left(\frac{1}{2}\log\left(\det(\mathbf{R})\right)\right)-\frac{1}{2}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\frac{1}{\sigma^{2}}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\label{eq:maxLikeKrigingLog}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Der Maximum Likelihood Schätzer der globalen Varianz 
\begin_inset Formula $\sigma^{2}$
\end_inset

 für eine multivariate Normalverteilung ist:
\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align*}
\sigma^{2}= & \frac{1}{n}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Setzt man dies in den rechten Teil von Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maxLikeKrigingLog"

\end_inset

 ein, erhält man die vereinfachte Form:
\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align}
\log(N) & =-\frac{1}{2}\left(\log\left(\sigma^{2}\right)n+\log\left(\det(\mathbf{R})\right)+n\right)\label{eq:VereinfachterLikelihoodTerm}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Dieser Term ist nur noch abhängig von den Hyperparametern 
\begin_inset Formula $\vec{\theta}$
\end_inset

, welche zur Bildung der Korrelationsmatrix 
\begin_inset Formula $\mathbf{R}$
\end_inset

 und 
\begin_inset Formula $\sigma^{2}$
\end_inset

 benötigt werden: 
\end_layout

\begin_layout Standard
\noindent

\lang english
\begin_inset Formula 
\begin{align*}
L\left(\vec{\theta}\right)=-\frac{1}{2}\left(\log\left(\sigma^{2}\left(\overrightarrow{\theta}\right)\right)n+\log\left(\det(\mathbf{R\left(\overrightarrow{\theta}\right)})\right)+n\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Um diesen Maximum Likelihood Term zu minimieren bzw.
 zu maximieren, gibt es zahlreiche numerische Verfahren.
 Innerhalb dieser Arbeit wurden die beiden Verfahren RPROP (Resilient Propagatio
n) und Quasi Newton verwendet.
 Diese Verfahren werden in Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Minimierungsverfahren"

\end_inset

 genauer erläutert.
 In diesem Zusammenhang ist allerdings wichtig zu wissen, dass für beide
 Verfahren der Gradient 
\begin_inset Formula $\nabla L\left(\vec{\theta}\right)$
\end_inset

 der Funktion bekannt sein muss.
 Da die Funktion allerdings die beiden Funktionen 
\begin_inset Formula $\sigma^{2},\beta$
\end_inset

 enthält und diese ebenfalls von 
\begin_inset Formula $\vec{\theta}$
\end_inset

 abhängig sind, ergibt sich laut Kettenregel:
\end_layout

\begin_layout Standard

\lang english
\begin_inset Formula 
\begin{align}
\nabla L\left(\vec{\theta}\right) & =\frac{\partial L}{\partial R}\frac{\partial\mathbf{R}}{\partial\vec{\theta}}+\frac{\partial L}{\partial\beta}\frac{\partial\beta}{\partial\vec{\theta}}+\frac{\partial L}{\partial\sigma^{2}}\frac{\partial\sigma^{2}}{\partial\vec{\theta}}\label{eq:GradientLikelihoodTheta}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Der globale Erwartungswert 
\begin_inset Formula $\beta$
\end_inset

 wird ebenfalls über einen Maximum Likelihood Schätzer für eine multivariate
 Normalverteilung bestimmt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial\left(\log(N)\right)}{\partial\beta} & =\frac{\partial}{\partial\beta}\left[\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\frac{1}{\sigma^{2}}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right]=0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial\left(\log(N)\right)}{\partial\beta}=0 & =-\overrightarrow{F}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)-\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{R}^{-1}\overrightarrow{F}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\Longrightarrow\beta=\frac{\vec{y}_{s}^{T}\mathbf{R}^{-1}\vec{F}}{\vec{F}^{T}\mathbf{R}^{-1}\vec{F}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Da 
\begin_inset Formula $\sigma^{2}$
\end_inset

 und 
\begin_inset Formula $\beta$
\end_inset

 durch die MLH Schätzung selbst optimale Werte darstellen, werden die entspreche
nden partiellen Ableitungen in Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GradientLikelihoodTheta"

\end_inset

 Null und es bleibt:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\nabla L\left(\vec{\theta}\right) & =\frac{\partial L}{\partial R}\frac{\partial\mathbf{R}}{\partial\vec{\theta}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Da die hier verwendeten numerischen Verfahren minimieren und nicht maximieren,
 wird die Funktion vom Vorzeichen umgedreht:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\min\left(L\left(\vec{\theta}\right)\right)=-\max\left(L\left(\vec{\theta}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Bildet man nun die partielle Ableitung nach 
\begin_inset Formula $\partial\theta_{l}$
\end_inset

 der Likelihood Funktion, wobei 
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\frac{\partial\det(\mathbf{R})}{\partial\theta_{l}}=\det(\mathbf{R})\textrm{Spur}\left(\mathbf{R}^{-1}\frac{\partial\mathbf{R}}{\partial\theta_{l}}\right)$
\end_inset

 
\begin_inset space ~
\end_inset

und
\begin_inset space ~
\end_inset

 
\begin_inset Formula $\frac{\partial\mathbf{R}^{-1}}{\partial\theta_{l}}=-\mathbf{R}^{-1}\frac{\partial\mathbf{R}}{\partial\theta_{l}}\mathbf{R}^{-1}$
\end_inset


\end_layout

\begin_layout Standard

\lang english
\begin_inset Formula 
\begin{align}
\frac{\partial L\left(\vec{\theta}\right)}{\partial\theta_{l}} & =\frac{1}{2}\left[\textrm{Spur}\left(\mathbf{R}^{-1}\frac{\partial\mathbf{R}}{\partial\theta_{l}}\right)-\frac{1}{\sigma^{2}}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{R}^{-1}\frac{\partial\mathbf{R}}{\partial\theta_{l}}\mathbf{R}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right]\label{eq:AbleitungLikelihood}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\noindent
Mit dieser Ableitung ist es nun möglich, die numerischen Minimierer effizient
 zu nutzen, um die optimalen Hyperparameter zu bestimmen.
 
\end_layout

\begin_layout Section
\noindent
Maximum Likelihood mit Kovarianzmatrix 
\begin_inset CommandInset label
LatexCommand label
name "sec:Maximum-LikelihoodCovariance"

\end_inset


\end_layout

\begin_layout Standard
Möchte man während des Trainings nicht den Likelihood Schätzer für die Varianz
 der Normalverteilung verwenden, wie es beim CoKriging nötig werden kann,
 müssen einige Gleichungen verändert werden:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
N= & \frac{1}{\left(2\pi\right)^{\frac{n}{2}}\det\left(\mathbf{Cov}\right)^{\frac{1}{2}}}e^{-\frac{1}{2}\left(\vec{y}_{s}-\vec{F}\beta\right)^{T}\mathbf{Cov^{\textrm{-1}}}\left(\vec{y}_{s}-\vec{F}\beta\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\log(N)= & \log(1)-\frac{n}{2}\log(2\pi)-\frac{1}{2}\log\left(\det(\mathbf{\mathbf{Cov}})\right)-\frac{1}{2}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da das Maximum der Funktion gesucht ist, können die Konstanten ignoriert
 werden:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\log(N)= & -\log\left(\det(\mathbf{\mathbf{Cov}})\right)-\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da im Co-Kriging die Prozessvarianz 
\begin_inset Formula $\sigma^{2}$
\end_inset

 nicht mehr durch einen Maximum Likelihood Schätzer bestimmt werden kann,
 muss dies in der Ableitung der Likelihoodfunktion berücksichtigt werden.
 Also geht man davon aus, dass die Kovarianzmatrix von einem beliebigen
 Hyperparameter 
\begin_inset Formula $h$
\end_inset

 abhängt, so kann man die Ableitung wie folgt bilden:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\frac{\partial L\left(\vec{h}\right)}{\partial h_{l}}= & -\frac{\partial}{\partial h_{l}}\left(\log\left(\det(\mathbf{\mathbf{Cov}})\right)\right)-\frac{\partial}{\partial h_{l}}\left(\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\frac{\partial L\left(\vec{h}\right)}{\partial h_{l}}= & -\frac{1}{\det(\mathbf{\mathbf{Cov}})}\frac{\partial}{\partial h_{l}}\left(\det(\mathbf{\mathbf{Cov}})\right)-\frac{\partial}{\partial h_{l}}\left(\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Es gilt Allgemein: 
\begin_inset Formula $\frac{\partial\det(\mathbf{\mathbf{\mathbf{Cov}}})}{\partial h_{l}}=\det(\mathbf{\mathbf{\mathbf{Cov}}})\textrm{Spur}\left(\mathbf{\mathbf{Cov}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\right)$
\end_inset

 
\begin_inset space ~
\end_inset

und
\begin_inset space ~
\end_inset

 
\begin_inset Formula $\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}^{-1}}{\partial h_{l}}=-\mathbf{\mathbf{\mathbf{Cov}}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\mathbf{\mathbf{Cov}}^{-1}$
\end_inset


\end_layout

\begin_layout Standard
Daraus folgt:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\frac{\partial L\left(\vec{h}\right)}{\partial h_{l}}= & -\frac{\det(\mathbf{\mathbf{\mathbf{Cov}}})}{\det(\mathbf{\mathbf{Cov}})}\textrm{Spur}\left(\mathbf{\mathbf{Cov}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\right)+\left(\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{\mathbf{Cov}}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula 
\begin{align*}
\frac{\partial L\left(\vec{h}\right)}{\partial h_{l}}= & -\textrm{Spur}\left(\mathbf{\mathbf{Cov}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\right)+\left(\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)^{T}\mathbf{\mathbf{\mathbf{Cov}}}^{-1}\frac{\partial\mathbf{\mathbf{\mathbf{Cov}}}}{\partial h_{l}}\mathbf{\mathbf{Cov}}^{-1}\left(\vec{y}_{s}-\beta\overrightarrow{F}\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Section
Regularisierungsterm und Nugget 
\end_layout

\begin_layout Subsection
Regularisierungsterm
\end_layout

\begin_layout Standard
Während des Ersatzmodelltrainings kann es dazu kommen, dass die Kovarianzmatrix
 
\begin_inset Formula $\mathbf{Cov}$
\end_inset

 schlecht konditioniert ist und es dadurch zu numerischen Problemen kommt.
 Um dies zu vermeiden gibt es grundsätzlich mehrere Möglichkeiten.
 
\end_layout

\begin_layout Enumerate
Ein numerisches stabiles Verfahren zur Zerlegung/Invertierung verwenden,
 bspw.
 SVD
\end_layout

\begin_layout Enumerate
Die Konditionierung der Matrix als Nebenbedingung beim Training einführen
\end_layout

\begin_layout Enumerate
Ein fixer Regularisierungsterm
\end_layout

\begin_layout Standard
Als numerisches Verfahren zur Zerlegung von symmetrischen positiv definitiven
 Matrizen bietet sich in diesem Fall eigentlich nur die Cholesky Zerlegung
 an (siehe Kapitel 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Cholesky-Zerlegung"

\end_inset

).
 Andere Verfahren wie das SVD sind numerisch zu aufwendig und würden das
 Training deutlich verlangsamen.
 Zudem gibt es von der Cholesky Zerlegung sehr effiziente Bibliotheksfunktionen,
 bspw.
 in der Intel Math Kernel Library oder den Nvidia CUDA Tools.
 Aus diesen Gründen kommt der erste Punkt nicht in Frage.
\end_layout

\begin_layout Standard
Im Folgenden sollen Lösungsvorschläge für die anderen beiden Punkte diskutiert
 werden.
\end_layout

\begin_layout Subsubsection
Konditionierung als Nebenbedinung für das Training
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\left|\frac{\Xi_{max}\left(R\right)}{\Xi_{min}\left(R\right)}\right|
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da R immer positiv definit sein muss
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\frac{\Xi_{max}\left(R\right)}{\Xi_{min}\left(R\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Der betragsmäßig maximale Eigenwerte kann mit dem Mises / Potenzverfahren
 gut gefunden werden.
 Um den minimalen zu finden nutzt man folgenden Zusammenhang:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{min}\left(R\right)= & \frac{1}{\Xi_{max}\left(R^{-1}\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\Xi_{max}\left(R^{-1}\right)$
\end_inset

 kann mit dem Mises Verfahren ohne Probleme gefunden werden.
\end_layout

\begin_layout Standard
Die Ableitung der Konditionierung nach den Hyperparametern:
\begin_inset Formula 
\begin{align*}
\frac{\partial\kappa}{\partial\theta} & =\frac{\frac{\partial\Xi_{max}}{\partial\theta}\Xi_{min}-\Xi_{max}\frac{\partial\Xi_{min}}{\partial\theta}}{\Xi_{min}^{2}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die Eigenwerte werden wie folgt abgeleitet:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
R\vec{x} & =\Xi\vec{x}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(R\vec{x}\right)^{T} & =\left(\Xi\vec{x}\right)^{T}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{x}^{T}R^{T} & =\Xi\vec{x}^{T}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial R\vec{x}}{\partial\theta} & =\frac{\partial\Xi\vec{x}}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial R}{\partial\theta}\vec{x}+R\frac{\partial\vec{x}}{\partial\theta} & =\frac{\partial\Xi}{\partial\theta}\vec{x}+\Xi\frac{\partial\vec{x}}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{x}^{T}\frac{\partial R}{\partial\theta}\vec{x}+\vec{x}^{T}R\frac{\partial\vec{x}}{\partial\theta} & =\vec{x}^{T}\frac{\partial\Xi}{\partial\theta}\vec{x}+\vec{x}^{T}\Xi\frac{\partial\vec{x}}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
da die Matrix symmetrisch ist
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
R^{T} & =R
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{x}^{T}\frac{\partial R}{\partial\theta}\vec{x}+\vec{x}^{T}R\frac{\partial\vec{x}}{\partial\theta}-\vec{x}^{T}R^{T}\frac{\partial\vec{x}}{\partial\theta}=\vec{x}^{T}\frac{\partial\Xi}{\partial\theta}\vec{x}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{x}^{T}\frac{\partial R}{\partial\theta}\vec{x}+\vec{x}^{T}R\frac{\partial\vec{x}}{\partial\theta}-\vec{x}^{T}R\frac{\partial\vec{x}}{\partial\theta}=\vec{x}^{T}\frac{\partial\Xi}{\partial\theta}\vec{x}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\vec{x}^{T}\frac{\partial R}{\partial\theta}\vec{x}=\frac{\partial\Xi}{\partial\theta}\vec{x}^{T}\vec{x}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\vec{x}^{T}\frac{\partial R}{\partial\theta}\vec{x}}{\vec{x}^{T}\vec{x}}=\frac{\partial\Xi}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial\kappa}{\partial\theta} & =\frac{\frac{\vec{x}_{max}^{T}\frac{\partial R}{\partial\theta}\vec{x}_{max}}{\vec{x}_{max}^{T}\vec{x}_{max}}\Xi_{min}-\Xi_{max}\frac{\vec{x}_{min}^{T}\frac{\partial R}{\partial\theta}\vec{x}_{min}}{\vec{x}_{min}^{T}\vec{x_{min}}}}{\Xi_{min}^{2}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die Eigenwerte nach dem Diagonalaufschlag abgeleitet:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial R\vec{x}}{\partial\lambda} & =\frac{\partial\Xi\vec{x}}{\partial\lambda}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\vec{x}^{T}Ee^{\lambda}\vec{x}}{\vec{x}^{T}\vec{x}}=\frac{\partial\Xi}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
e^{\lambda}=\frac{\partial\Xi}{\partial\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die Gradienten der Nebenbedingung können hier sehr große werden und die
 Nebenbedingung tendiert dann immer gegen eine Einheitsmatrix für R.
 Zudem ist der Berechnungsaufwand relativ hoch und der Gradient basiert
 auf der Inversen, was widerum zu Fehlern führen kann.
\end_layout

\begin_layout Standard
bei der Diese Probleme werden innerhalb der Zerlegung erkannt und führen
 dann zu einem Abbruch des Trainings.
\end_layout

\begin_layout Standard
Probleme benennen die bei der Cholesky auftreten können und warum.
\end_layout

\begin_layout Standard
1.
 Regularisierungsterm: Untere Grenze des Diagonalauschlags, zur Verbesserung
 der Konditionierung der Matrix 
\end_layout

\begin_layout Subsection
Nugget Effekt
\end_layout

\begin_layout Standard
2.
 Nugget Effekt: Varianz an einem bereits beprobten Ort normalerweise=0 (interpol
ierend), streuen die Werte an einem bereits beprobten Ort, spricht man vom
 Nugget Effekt, da dort die Varianz dann größer wird und das Modell approximiert.
 Kann als Hyperparameter mit trainiert werden.
 Dominiert das Training allerdings oftmals und sollte daher nur verwendet
 werden, wenn verrauschte Funktionen erwartet werden.
 Dies ist im Falle von Strömungssimulationen nicht zu erwarten, da ein Parameter
satz zu reproduzierbaren Ergebnissen führen sollte.
 
\end_layout

\begin_layout Subsection
Verbindung zwischen beiden
\end_layout

\begin_layout Subsection*
Regularisierungsterm einstellen über eine maximale Konditionszahl
\end_layout

\begin_layout Standard
Während des Trainings kann es passieren, dass Hyperparameter eingestellt
 werden, die eine schlechte Konditionierung der Korrelationsmatrix hervorrufen.
 Dies kann bei der Cholesky Zerlegung problematisch werden.
 Um die Konditionszahl zu verbessern, wird ein Diagonalaufschlag auf die
 Hauptdiagonale der Matrix addiert.
 Die Gauss Korrelationsfunktion würde sich damit wie folgt ändern (
\begin_inset Formula $\delta_{i,j}$
\end_inset

 beschreibt hier das Kronecker Delta und 
\begin_inset Formula $\lambda$
\end_inset

 den Diagonalaufschlag):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
c\left(\vec{x}_{i},\vec{x}_{j}\right) & =e^{-\frac{1}{2}\underset{l=1}{\overset{l<k}{\sum}}\left(e^{\theta_{l}}\left|x_{i,l}-x_{j,l}\right|^{2}\right)}+e^{\lambda}\delta_{i,j}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Es stellt sich allerdings die Frage, wie groß dieser Diagonalaufschlag im
 Einzelfall sein muss und inwiefern dieser das Ergebnis beeinflusst bzw.
 die Kondition verbessert.
 Grundsätzlich sollte dieser so klein wie möglich gewählt werden, um die
 Ursprungsmatrix so wenig wie möglich zu verändern.
 Um einen optimalen Wert zu ermitteln, gibt es zwei verschiedene Möglichkeiten.
 
\end_layout

\begin_layout Standard
Die erste Möglichkeit wäre, die Likelihood Funktion (siehe Gleichung 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Likelihood Funktion"

\end_inset

) nach dem Diagonalaufschlag zu differenzieren.
 Die Ableitung ist in diesem Fall sehr simpel, da alles außer dem Diagonalaufsch
lag wegfällt:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial c\left(\vec{x}_{i},\vec{x}_{j}\right)}{\partial\lambda} & =e^{\lambda}\delta_{i,j}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die Ableitung der Korrelationsmatrix nach dem Diagonalaufschlag ergibt also
 eine Einheitsmatrix multipliziert mit dem Diagonalaufschlag:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{\frac{\partial R}{\partial\lambda}} & =e^{\lambda}\mathbf{E}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Damit ergibt sich die Ableitung der Likelihood Funktion nach dem Diagonalaufschl
ag zu:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\frac{\partial L}{\partial\lambda} & =\frac{e^{\lambda}}{2}\left[\textrm{Spur}\left(\mathbf{R}^{-1}\right)-\frac{1}{\sigma^{2}}(\vec{y}_{s}-\beta*\overrightarrow{F})^{T}\mathbf{R}^{-1}\mathbf{R}^{-1}(\vec{y}_{s}-\beta*\overrightarrow{F})\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Mit dieser Formel wäre es nun möglich, den Diagonalaufschlag einfach als
 zusätzlichen Hyperparameter zu minimieren.
 Allerdings bedeutet dies natürlich einen zusätzlicher Aufwand.
 Es soll daher nach einer einfacheren Methode gesucht werden.
 
\end_layout

\begin_layout Standard
Ein anderer möglicher Ansatz ist die Konditionszahl der Matrix.
 Diese ist definiert als Quotient aus maximalem und minimalem Eigenwert
 der Korrelationsmatrix:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\left|\frac{\Xi_{max}\left(\mathbf{R}\right)}{\Xi_{min}\left(\mathbf{R}\right)}\right|
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Überlegt man sich nun, welche Korrelationsmatrix am schlechtesten konditioniert
 wäre, kommt man auf die Einsmatrix:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mathbf{R} & =\left[\begin{array}{ccc}
1 & ... & 1\\
... & ... & ...\\
1 & ... & 1
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Die minimalen und maximalen Eigenwerte der Einsmatrix sind bekannt:
\begin_inset Formula 
\begin{align*}
\Xi_{min}\left(\mathbf{R}\right) & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{max}\left(\mathbf{R}\right) & =n
\end{align*}

\end_inset

Dies würde einer unendlichen Konditionszahl entsprechen:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\infty
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Addiert man nun den Diagonalaufschlag, bekommt man folgende Korrelationsmatrix:
 
\begin_inset Formula 
\begin{align*}
\mathbf{R} & =\left[\begin{array}{ccc}
1+e^{\lambda} & ... & 1\\
... & ... & ...\\
1 & ... & 1+e^{\lambda}
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Daraus ergeben sich die folgenden neuen maximalen und minimalen Eigenwerte:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{min}\left(\mathbf{R}\right) & =e^{\lambda}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{max}\left(\mathbf{R}\right) & =e^{\lambda}+n
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Und die entsprechende Konditionszahl verbessert sich zu:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\left|\frac{e^{\lambda}+n}{e^{\lambda}}\right|
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da die Matrix positiv definit sein muss und damit nur positive Eigenwerte
 hat, kann der Betrag weggelassen werden:
\begin_inset Formula 
\begin{align*}
\kappa & =\frac{e^{\lambda}+n}{e^{\lambda}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Wählt man nun für die Konditionszahl eine obere Grenze, bekommt man eine
 Untergrenze für den Diagonalaufschlag:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa_{max} & >\frac{e^{\lambda}+n}{e^{\lambda}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
e^{\lambda} & >\frac{n}{\left(\kappa_{max}-1\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Eine geeignete Grenze für die obere Grenze der Konditionszahl ist aus der
 Erfahrung bekannt und liegt bei ca.
 
\begin_inset Formula $10^{9}$
\end_inset

, dieser Wert kann im Einzelfall natürlich angepasst werden.
 Der daraus resultierende Diagonalaufschlag würde bei einer üblichen Matrixgröße
 von 5000x5000, 
\begin_inset Formula $5*10^{-6}$
\end_inset

 betragen und es ist davon auszugehen, dass dieser so gut wie keinen Einfluss
 auf das Endergebnis haben sollte.
 
\begin_inset Formula $ $
\end_inset


\end_layout

\begin_layout Standard
Diese Art der Berechnung des Diagonalaufschlags wird momentan im Code verwendet.
 Die entsprechende Ableitung der Likelihood Funktion ist im Code bereits
 umgesetzt, wird momentan allerdings nicht verwendet, da bisherige Tests
 dafür noch keine Notwendigkeit zeigten.
\end_layout

\begin_layout Subsection*
Diagonalaufschlag als Faktor
\end_layout

\begin_layout Standard
Multipliziert man nun den Diagonalaufschlag, bekommt man folgende Korrelationsma
trix: 
\begin_inset Formula 
\begin{align*}
\mathbf{R} & =\left[\begin{array}{ccc}
1\lambda & ... & 1\\
... & ... & ...\\
1 & ... & 1\lambda
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Daraus ergeben sich die folgenden neuen maximalen und minimalen Eigenwerte:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{min}\left(\mathbf{R}\right) & =1
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\Xi_{max}\left(\mathbf{R}\right) & =\lambda+n-1
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Und die entsprechende Konditionszahl verbessert sich zu:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa & =\left|\frac{\lambda+n-1}{\lambda-1}\right|
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Da die Matrix positiv definit sein muss und damit nur positive Eigenwerte
 hat, kann der Betrag weggelassen werden:
\begin_inset Formula 
\begin{align*}
\kappa & =\frac{\lambda+n-1}{\lambda-1}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Wählt man nun für die Konditionszahl eine obere Grenze, bekommt man eine
 Untergrenze für den Diagonalaufschlag:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\kappa_{max} & >\frac{\lambda+n-1}{\lambda-1}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\lambda & >\frac{n-1+\kappa_{max}}{\left(\kappa_{max}-1\right)}
\end{align*}

\end_inset


\end_layout

\end_body
\end_document
